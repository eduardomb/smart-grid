!function(o){"use strict";o.fn.grid=function(i){function t(o){return o+"px"}function s(o,i){if(i[u]+o.cols-1>=v.cols)return!1;for(var t=i[f];t<i[f]+o.rows;t++)for(var s=i[u];s<i[u]+o.cols;s++)if(void 0!==p[t]&&p[t][s])return!1;return!0}function n(i,s,n){var l=o("<div></div>");l.css({height:"0","border-bottom-color":v.hLineColor,"border-bottom-width":t(v.hLineThickness),"border-bottom-style":"dotted",position:"absolute",width:t((n-s)*(S+w)+S),left:t(s*(S+w)),top:t(h*(S+w)+S+v.hSpacing)}),i.append(l)}var l,e,r,c,h,d,f=0,u=1,v=o.extend({cols:3,hSpacing:10,vSpacing:10,hLineThickness:1,vLineThickness:1,hLineColor:"#ccc",vLineColor:"#ccc",selector:"div"},i),a=0,p=[],b=[],g=[],w=2*v.vSpacing+v.vLineThickness,L=2*v.hSpacing+v.hLineThickness,S=(this.width()-(v.cols-1)*w)/v.cols;if("fixed"==this.css("position"))return o.error("Grid objects can't have position: fixed on CSS."),this;for("static"==this.css("position")&&this.css("position","relative"),o(v.selector,this).each(function(){for(var i=[0,0],n={id:++a,cols:o(this).data("cols"),rows:o(this).data("rows")};!s(n,i);)i[u]<v.cols?i[u]+=1:(i[f]+=1,i[u]=0);for(r=i[f];r<i[f]+n.rows;r++)for(void 0===p[r]&&(p[r]=[]),c=i[u];c<i[u]+n.cols;c++)p[r][c]=a;if(i[f]>0)for(void 0===g[i[f]-1]&&(g[i[f]-1]=[]),r=i[u];r<i[u]+n.cols;r++)g[i[f]-1][r]=!0;if(i[u]>0)for(r=i[f];r<i[f]+n.rows;r++)void 0===b[r]&&(b[r]=[]),b[r][i[u]-1]=!0;o(this).css({position:"absolute",display:"inline-block",width:t(n.cols*(S+w)-w),height:t(n.rows*(S+L)-L),left:t(i[u]*(S+w)),top:t(i[f]*(S+L))})}),d=0;d<v.cols-1;d++)for(l=null,e=null,h=0;h<b.length;){for(;void 0!==b[h++]&&b[h-1][d];)null===l?(l=h-1,e=h-1):e=h-1;if(null!==l&&null!==e){var k=o("<div></div>");k.css({width:"0","border-left-width":t(v.vLineThickness),"border-left-style":"dotted","border-left-color":v.vLineColor,position:"absolute",height:t((e-l)*(S+L)+S),left:t(d*(S+w)+S+v.vSpacing),top:t(l*(S+L))}),this.append(k),l=null,e=null}}for(h=0;h<g.length;h++)for(l=null,e=null,d=0;void 0!==g[h]&&d<v.cols;){for(;g[h][d++];)null===l?l=d-1:void 0!==b[h]&&void 0!==b[h+1]&&b[h][d-2]&&b[h+1][d-2]&&(n(this,l,e),l=d-1),e=d-1;null!==l&&null!==e&&(n(this,l,e),l=null,e=null)}return this.height(p.length*(S+L)),this}}(jQuery);